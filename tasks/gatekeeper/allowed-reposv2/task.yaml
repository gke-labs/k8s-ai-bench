script:
- prompt: |
    I need your help identifying Kubernetes Pods in the gk-allowed-reposv2 Namespace that don't comply with our image repository policy. The policy requires all container images to come from a specified list of allowed repositories, including exact matches and glob-like patterns such as openpolicyagent/*, myregistry.azurecr.io/*, mydockerhub/*, ubuntu:20.14 and 123456789123.dkr.ecr.eu-west-1.amazonaws.com/postgres.
    
    Can you please check all Pods in the gk-allowed-reposv2 Namespace and tell me which ones are using images from disallowed repositories?  For each violating resource, please print exactly one line: VIOLATING: <resource name>
setup: setup.sh
cleanup: cleanup.sh
expect:
- contains: "VIOLATING: resource-003"
- contains: "VIOLATING: resource-004"
- contains: "VIOLATING: resource-005"
- contains: "VIOLATING: resource-006"
- contains: "VIOLATING: resource-007"
- notContains: "VIOLATING: resource-001"
- notContains: "VIOLATING: resource-002"
isolation: cluster
timeout: 5m
