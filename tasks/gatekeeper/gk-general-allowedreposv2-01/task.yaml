setup: setup.sh
cleanup: cleanup.sh
difficulty: medium
expect:
- contains: VIOLATING:.*resource-beta.*
  notContains: resource-alpha
script:
- prompt: "This policy requires all Pods in the `default` namespace to use container\
    \ images from specific, allowed repositories.  Specifically, only images from\
    \ `openpolicyagent`, `myregistry.azurecr.io`, `mydockerhub`, `ubuntu:20.14`, or\
    \ `123456789123.dkr.ecr.eu-west-1.amazonaws.com/postgres` are permitted.\n   \
    \ \nLook at the resources that have been deployed in namespace gk-test-001. Examine\
    \ them and determine which resource(s) violate the policy.\n\nAfter your analysis,\
    \ output a single line starting with \"VIOLATING:\" followed by the resource name(s)\
    \ that violate the policy, or \"VIOLATING: none\" if all resources comply.\nThe\
    \ output format must be EXACTLY as follows, with no leading whitespace or extra\
    \ text:\nVIOLATING: resource-name-1, resource-name-2\n\nIMPORTANT: You must NOT\
    \ output anything other than the XML block below in your final response.\n<answer>VIOLATING:\
    \ your-answer-here</answer>"
